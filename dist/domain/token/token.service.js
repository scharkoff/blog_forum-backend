"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _mongoose=_interopRequireDefault(require("mongoose")),_jsonwebtoken=_interopRequireDefault(require("jsonwebtoken")),_Token=_interopRequireDefault(require("./entity/Token.js"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class TokenService{generateTokens(a){const b=_jsonwebtoken.default.sign(a,process.env.ACCESS_TOKEN_SECRET_KEY,{expiresIn:"15m"}),c=_jsonwebtoken.default.sign(a,process.env.REFRESH_TOKEN_SECRET_KEY,{expiresIn:"30d"});return{accessToken:b,refreshToken:c}}async save(a,b){const c=await _Token.default.findOne({user:_mongoose.default.Types.ObjectId(a)});if(c)return c.refreshToken=b,c.save();const d=await _Token.default.create({user:_mongoose.default.Types.ObjectId(a),refreshToken:b});return d}async removeToken(a){const b=await _Token.default.deleteOne({refreshToken:a});if(0===b.deletedCount)throw new Error("Refresh token was not found")}async findToken(a){const b=await _Token.default.findOne({refreshToken:a});if(!b)throw new Error("Refresh token was not found")}}exports.default=TokenService;